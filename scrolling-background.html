<link rel="import" href="../polymer/polymer.html" />

<dom-module id="scrolling-background">
	<style>
		#background {
			background-size: cover !important;
			background-position: 50% 50% !important;
			bottom: 0;
			left: 0;
			position: fixed;
			right: 0;
			top: 0;
			transition: background 0.3s;
		}
		#information-container {
			position: fixed;
			top: 0;
			bottom: 0;
			left: 0;
			right: 0;
			overflow-y: auto;
		}
	</style>
	<template>
		<div id="background" style$="background-image: url({{activeBackground}})">
			a
		</div>
		<div id="information-container" on-scroll="scroller">
			<content></content>
		</div>
	</template>
	<script src="../jquery/dist/jquery.min.js"></script>
	<script>
	Polymer({
		is: 'scrolling-background',
		properties: {
			activeBackground: {
				type: String,
				value: ''
			}
		},
		backgroundsCollection: [],
		windowSize: {
			height: Number,
			width: Number
		},
		ready: function () {
			var nodeList = document.querySelectorAll('background-element'),
				i;
			for(i = 0; i < nodeList.length; i++) {
				this.backgroundsCollection.push(nodeList[i].getAttribute('background'));
			}
			this.activeBackground = this.backgroundsCollection[0];
		},
		attached: function () {
			var that = this,
				getWindowSize = function () {
					that.windowSize.height = $(that.$.background).height();
					that.windowSize.width = $(that.$.background).width();
				};
			getWindowSize();
			$(window).resize(getWindowSize);
		},
		scroller: function(event) {
			var target = $(event.target),
				that = this,
				ratio = parseInt(target.scrollTop() / this.windowSize.height);
			this.activeBackground = this.backgroundsCollection[ratio];
		}
	});
	</script>
</dom-module>